<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Compiling RDFHDT C&#43;&#43; tools on UPPMAX (RHEL/CentOS 7) | Living Systems</title>

      <link rel="stylesheet" href="/css/main.min.0501cde787a831c36705f20a2589d2156b6b699bcf7c5b749bb4b5842d0bff5e.css" integrity="sha256-BQHN54eoMcNnBfIKJYnSFWtraZvPfFt0m7S1hC0L/14=" crossorigin="anonymous">


      <script src="/js/main.23cd0c7d837263b9eaeb96ee2d9ccfa2969daa3fa00fa1c1fe8701a9b87251a1.js" integrity="sha256-I80MfYNyY7nq65buLZzPopadqj&#43;gD6HB/ocBqbhyUaE=" crossorigin="anonymous"></script>



</head>
<body>
  <header>
    <h1>Living Systems</h1>

  <nav>
    <ul>
    <li>
      <a href="/">Home</a>
    </li>
    <li>
      <a aria-current="true" class="ancestor" href="/posts/">Posts</a>
    </li>
    <li>
      <a href="/tags/">Tags</a>
    </li>
    </ul>
  </nav>


  </header>
  <main>
    
  <h1>Compiling RDFHDT C&#43;&#43; tools on UPPMAX (RHEL/CentOS 7)</h1>

  
  
  <time datetime="2017-09-13T18:04:00&#43;02:00">September 13, 2017</time>

  <!-- raw HTML omitted -->
<p>At <a href="http://pharmb.io" target="_blank" rel="noopener">pharmb.io</a>
 we are researching how to use semantic
technologies to push the boundaries for what can be done with
intelligent data processing, often of large datasets (see e.g. our
<a href="http://dx.doi.org/10.1186/2041-1480-2-S1-S6" target="_blank" rel="noopener">paper on linking RDF to cheminformatics and
proteomics</a>
, and <a href="http://dx.doi.org/10.1186/s13326-017-0136-y" target="_blank" rel="noopener">our work
on the RDFIO software
suite</a>
). Thus, for us,
RDFHDT opens new possibilites. As we are heavy users of the <a href="http://www.uppmax.uu.se" target="_blank" rel="noopener">UPPMAX HPC
center</a>
 for our computations, and so, we need
to have the HDT tools available there. This post will outline the steps
to compile the <a href="https://github.com/rdfhdt/hdt-cpp" target="_blank" rel="noopener">C++ HDT commandline tool
suite</a>
 from source.</p>
<h2 id="dependencies">Dependencies</h2>
<p>Firstly, we should specify the system on which we are running this. We
are running on CentOS 7.3, or more exactly, 7.3.1611, which can be seen
with this command:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat /etc/redhat-release
</span></span><span style="display:flex;"><span>CentOS Linux release 7.3.1611 (Core)
</span></span></code></pre></div><p>You will also need the following yum packages installed (install with
yum install &lt;package-name&gt;):</p>
<ul>
<li>yum-utils (for the yumdownloader tool used below)</li>
</ul>
<h2 id="compiling">Compiling</h2>
<p>The steps we took are as follows:</p>
<p>1. Clone from git</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git clone https://github.com/rdfhdt/hdt-cpp.git
</span></span></code></pre></div><p>2. Go into hdt-lib inside the cloned directory:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd hdt-cpp/hdt-lib
</span></span></code></pre></div><p>3. Download raptor and yalj libraries:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>yumdownloader raptor2.x86_64 raptor2-devel.x86_64 yajl.x86_64 yajl-devel.x86_64
</span></span></code></pre></div><p>4. Unpack all the .rpm files:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#00f">for</span> f in *.rpm; <span style="color:#00f">do</span>
</span></span><span style="display:flex;"><span>   rpm2cpio $f | cpio -idmv;
</span></span><span style="display:flex;"><span><span style="color:#00f">done</span>;
</span></span></code></pre></div><p>5. Download the serd library:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>wget http://download.drobilla.net/serd-0.28.0.tar.bz2
</span></span></code></pre></div><p>6. Unpack the serd library:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>tar -jxvf serd-0.28.0.tar.bz2
</span></span></code></pre></div><p>7. Rename the serd folder to serd-0:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mv serd-0.28.0 serd-0
</span></span></code></pre></div><p>8. Enter the serd folder:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd serd-0
</span></span></code></pre></div><p>9. Compile the serd library:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./waf configure
</span></span><span style="display:flex;"><span>./waf
</span></span></code></pre></div><p>(The generated .so file will be put in a &quot;build&quot; folder under the serd
folder)</p>
<p>10. Exit the serd folder, back into the hdt-lib folder:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd ..
</span></span></code></pre></div><p>11. Then edit the Makefile as follows:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-diff" data-lang="diff"><span style="display:flex;"><span>--- a/hdt-lib/Makefile
</span></span><span style="display:flex;"><span>+++ b/hdt-lib/Makefile
</span></span><span style="display:flex;"><span><span style="font-weight:bold">@@ -17,14 +17,14 @@ FLAGS=-O3 -Wno-deprecated -Wall -Wextra -Wno-unused-parameter -Wno-sign-compare
</span></span></span><span style="display:flex;"><span><span style="font-weight:bold"></span> endif
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> INCLUDES=-I $(LIBCDSPATH)/includes/ -I /usr/local/include -I ./include -I /opt/local/include -I /usr/include
</span></span><span style="display:flex;"><span>-LDFLAGS=
</span></span><span style="display:flex;"><span>+LDFLAGS=-Lusr/lib64 -Lserd-0/build
</span></span><span style="display:flex;"><span> DOXYGEN=doxygen
</span></span><span style="display:flex;"><span> DEFINES= -DHAVE_CDS
</span></span><span style="display:flex;"><span> LIB=$(LIBCDSPATH)/lib/libcds.a -L/usr/local/lib -lstdc++
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> ifeq ($(RAPTOR_SUPPORT), true)
</span></span><span style="display:flex;"><span> DEFINES:=$(DEFINES) -DHAVE_RAPTOR
</span></span><span style="display:flex;"><span>-LIB:=$(LIB) -lraptor2
</span></span><span style="display:flex;"><span>+LIB:=$(LIB) -lraptor2 -lyajl
</span></span><span style="display:flex;"><span> endif
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> ifeq ($(KYOTO_SUPPORT), true)
</span></span></code></pre></div><p>12. Compile the RDF HDT tools:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>make
</span></span></code></pre></div><p>13. Done! The generated tools should now be available in the &quot;tools&quot;
folder under your &quot;hdt-lib&quot; folder:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ls -1X tools/
</span></span><span style="display:flex;"><span>hdt2rdf
</span></span><span style="display:flex;"><span>hdtInfo
</span></span><span style="display:flex;"><span>hdtSearch
</span></span><span style="display:flex;"><span>modifyHeader
</span></span><span style="display:flex;"><span>rdf2hdt
</span></span><span style="display:flex;"><span>replaceHeader
</span></span><span style="display:flex;"><span>searchHeader
</span></span><span style="display:flex;"><span>hdt2rdf.cpp
</span></span><span style="display:flex;"><span>hdtInfo.cpp
</span></span><span style="display:flex;"><span>hdtSearch.cpp
</span></span><span style="display:flex;"><span>modifyHeader.cpp
</span></span><span style="display:flex;"><span>rdf2hdt.cpp
</span></span><span style="display:flex;"><span>replaceHeader.cpp
</span></span><span style="display:flex;"><span>searchHeader.cpp
</span></span></code></pre></div><h2 id="installing">Installing</h2>
<p>Now, to have these tools available everywhere, you might want to put
them in some folder under your home directory, and include them in your
PATH variable. You will also need to include the relevant library paths
in your LD_LIBRARY_PATH variable.</p>
<p>Given that you install them in ~/usr/bin like I did, this is how to do
that:</p>
<p>1. Copy the usr folder created in the hdt-lib folder when unpacking the
.rpm files, into your home folder:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cp -r usr ~/
</span></span></code></pre></div><p>2. Put the newly compiled HDT tools into the ~/usr/bin folder too:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cp tools/* ~/usr/bin/
</span></span></code></pre></div><p>3. Add the following lines to the end of your ~/.bashrc file (adapted
from <a href="https://unix.stackexchange.com/questions/2117/install-development-files-locally-to-build-on-system-without-root-access" target="_blank" rel="noopener">this
thread</a>
),
so that the binary and library search paths are always accessible in
your shell, so that you can run the hdt tools from anywhere on the file
system:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#008000"># Load local bin and library directories</span>
</span></span><span style="display:flex;"><span>export PATH=~/usr/bin:$PATH
</span></span><span style="display:flex;"><span>export LD_LIBRARY_PATH=~/usr/lib:$LD_LIBRARY_PATH
</span></span><span style="display:flex;"><span>export LD_LIBRARY_PATH=~/usr/lib64:$LD_LIBRARY_PATH
</span></span><span style="display:flex;"><span>export C_INCLUDE_PATH=~/usr/include:$C_INCLUDE_PATH
</span></span><span style="display:flex;"><span>export CPLUS_INCLUDE_PATH=~/usr/include:$CPLUS_INCLUDE_PATH
</span></span></code></pre></div><p>4. Reload the ~/.bashrc file:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>source ~/.bashrc
</span></span></code></pre></div><p>5. Done! Now you should be able to run a tool like rdf2hdt (for
converting RDF dat to HDT format) from anywhere in the file system:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ rdf2hdt
</span></span><span style="display:flex;"><span>ERROR: You must supply an input and output
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ rdf2hdt [options] &lt;rdf input file&gt; &lt;hdt output file&gt;
</span></span><span style="display:flex;"><span>        -h                      This help
</span></span><span style="display:flex;"><span>        -i              Also generate index to solve all triple patterns.
</span></span><span style="display:flex;"><span>        -c      &lt;configfile&gt;    HDT Config options file
</span></span><span style="display:flex;"><span>        -o      &lt;options&gt;       HDT Additional options (option1=value1;option2=value2;...)
</span></span><span style="display:flex;"><span>        -f      &lt;format&gt;        Format of the RDF input (ntriples, nquad, n3, turtle, rdfxml)
</span></span><span style="display:flex;"><span>        -B      <span style="color:#a31515">&#34;&lt;base URI&gt;&#34;</span>    Base URI of the dataset.
</span></span><span style="display:flex;"><span>        -V      Prints the HDT version number
</span></span></code></pre></div>
  


  </main>
  <footer>
    <p>Copyright &copy; 2024 Living Systems. All rights reserved.</p>

  </footer>
</body>
</html>
